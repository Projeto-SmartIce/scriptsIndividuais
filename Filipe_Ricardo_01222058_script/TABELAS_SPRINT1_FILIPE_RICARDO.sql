CREATE DATABASE Sprint1;
USE Sprint1;

CREATE TABLE EMPRESA (
ID INT PRIMARY KEY AUTO_INCREMENT,
CNPJ VARCHAR (22) ,
RAZÃO_SOCIAL VARCHAR (100),
NOME_FANTASIA VARCHAR (50),
CEP CHAR (9),
EMAIL_EMPRESA VARCHAR (100) DEFAULT "INFORMAR EMAIL DA EMPRESA" ,
TIPO VARCHAR (100), CONSTRAINT chkTIPO CHECK ( TIPO in ("MATRIZ", "FILIAL"))
);
ALTER TABLE EMPRESA ADD COLUMN TELEFONE VARCHAR(18);
DESC EMPRESA;
DROP TABLE EMPRESA;
TRUNCATE TABLE EMPRESA;



INSERT INTO EMPRESA VALUES 
(NULL,'61.068.276/0001-04 ', 'UNILEVER BRASIL LTDA','KIBON', '04543-011','Kibon.sovete@outlook.com', 'MATRIZ', NULL),
(NULL,'60.409.075/0001-52', 'NESTLÉ BRASIL LTDA', 'NESTLÉ BRASIL LTDA', '04583-916', 'nestle.sorvete@outlook.com', 'MATRIZ', NULL),
(NULL, '03.857.539/0001-50.','Sorveteria Creme Mel S.A', 'Creme Mel Sorvetes', '08574-020', 'creme.mel.brasil@sorvete@outlook.com', 'MATRIZ', NULL),
(NULL, '18.934.526/0001-43.','COMERCIO DE SORVETES ESKIMO LTDA', '	ESKIMO SORVETES', '1233-002.', 'creme.mel.brasil@sorvete@outlook.com', 'MATRIZ', NULL);



SELECT*FROM EMPRESA;


INSERT INTO EMPRESA VALUES 
(NULL,'61.068.276/0001-04 ', 'UNILEVER BRASIL LTDA','KIBON', '25135-011','Kibon.sovete.FILIAL@outlook.com', 'FILIAL', null),
(NULL,'60.409.075/0001-52', 'NESTLÉ BRASIL LTDA', 'NESTLÉ BRASIL LTDA', '51215-916', 'nestle.sorvete.FILIAL@outlook.com', 'FILIAL',null),
(NULL, '03.857.539/0001-50.','Sorveteria Creme Mel S.A', 'Creme Mel Sorvetes', '08574-020', 'creme.mel.brasil.FILIAL@sorvete@outlook.com', 'FILIAL',null);

SELECT*FROM EMPRESA;

UPDATE EMPRESA SET TELEFONE = '11 982866295'
WHERE ID = '1';
UPDATE EMPRESA SET TELEFONE = '11 977022950'
WHERE ID = '2';
UPDATE EMPRESA SET TELEFONE = '11 934236513'
WHERE ID = '3';
UPDATE EMPRESA SET TELEFONE = '11 940028922'
WHERE ID = '4';
UPDATE EMPRESA SET TELEFONE = '11 952856299'
WHERE ID = '5';
UPDATE EMPRESA SET TELEFONE = '11 955221389'
WHERE ID = '6';
UPDATE EMPRESA SET TELEFONE = '11 951512121'
WHERE ID = '7';


CREATE TABLE RESPONSAVEL  (
IdResponsavel INT PRIMARY KEY AUTO_INCREMENT,
NOME VARCHAR (100),
DATA_NASCIMENTO DATE,
EMAIL_RESPONSAVEL VARCHAR (80),
TELEFONE VARCHAR (100) DEFAULT 'SEM TELEFONE INFORMADDO',
EMPRESA  VARCHAR (100), CONSTRAINT chkEMPRESA CHECK (EMPRESA IN('KIBON', 'NESTLE BRASIL LTDA','CREME MEL SORVETES', 'ESKIMO SORVETES')),
TIPO_RESPONSAVEL VARCHAR(50), CONSTRAINT chkTIPO_RESPONSAVEL CHECK (TIPO_RESPONSAVEL IN ('FILIAL','MATRIZ')),
CNPJ VARCHAR (100),
fkEmpresa INT


);

DROP TABLE RESPONSAVEL;
TRUNCATE TABLE RESPONSAVEL;




INSERT INTO RESPONSAVEL VALUES
(NULL,'FILIPE', 20011210,'filipe.ricardo@KIBON.com', '11 98822699', 'KIBON', 'FILIAL','61.068.276/0001-04 ',5),
(NULL,'BRUNA', '20001120', 'bruna.silvao@KIBON.com', NULL, 'KIBON', 'MATRIZ','61.068.276/0001-04 ', 1),
(NULL,'WILLIAN', '19961005', 'wilian.paternezi@NESTLE.com', '11 965226399', 'NESTLE BRASIL LTDA', 'MATRIZ','60.409.075/0001-52',2),
(NULL,'ERICK', '20030521', 'erick.santos@NESTLE.com', NULL, 'NESTLE BRASIL LTDA', 'FILIAL','60.409.075/0001-52 ',6),
(NULL,'BIANCA', '20011010', 'bianca.bianca@CREMEL.COM', '11 964584699', 'CREME MEL SORVETES', 'MATRIZ','03.857.539/0001-50 ',3),
(NULL,'GIOVANA', '20020416', 'giovana.bonicheli@CREMEL.com', '11 982866299', 'CREME MEL SORVETES', 'FILIAL','03.857.539/0001-50 ',7),
(NULL,'EDUARDO', '20000515', 'eduardo.gabriel@ESKIMO.COM', '11 955022633', 'ESKIMO SORVETES', 'MATRIZ', '18.934.526/0001-43', NULL);  



ALTER TABLE RESPONSAVEL ADD FOREIGN KEY (fkEmpresa) REFERENCES EMPRESA(ID);
SELECT*FROM RESPONSAVEL JOIN EMPRESA ON fkEmpresa = ID ORDER BY EMPRESA.CEP ASC;



CREATE TABLE Sensor (
idSensor INT PRIMARY KEY auto_increment,
DISPOSITIVO VARCHAR(10),
LOCALIZAÇÃO  VARCHAR(100),
fkMEDIDA INT, 
FUNÇÃO VARCHAR (50), CONSTRAINT chkFUNÇÃO CHECK
(FUNÇÃO IN('TEMPERATURA','PROXIMIDADE','UMIDADE')),
EMPRESA VARCHAR(100)
);

DROP TABLE Sensor;
TRUNCATE TABLE Sensor;

INSERT INTO Sensor VALUES
(NULL, 'B35', 'BRASÍLIA',NULL, 'TEMPERATURA', 'NESTLE BRASIL LTDA'),
(NULL, 'A88', 'PERNAMBUCO',NULL, 'UMIDADE', ' CREME MEL SORVETES'),
(NULL, 'B35', 'BRASÍLIA',NULL, 'PROXIMIDADE', 'KIBON'),
(NULL, 'B35', 'SÃO PAULO',NULL, 'TEMPERATURA', 'KIBON');

CREATE TABLE MEDIDA (
idMEDIDA INT PRIMARY KEY AUTO_INCREMENT,
DATA_HORA DATETIME,
DADO_SENSOR VARCHAR (50),
fkSensor INT
);

DROP TABLE MEDIDA;
TRUNCATE TABLE MEDIDA;

ALTER TABLE MEDIDA ADD FOREIGN KEY (fkSensor) REFERENCES Sensor(idSensor);

INSERT INTO MEDIDA VALUES
(NULL,20221012163244,'-22 C', 1),
(NULL,20221012163244,NULL, 2),
(NULL,20221012163244,'ATIVO', 3),
(NULL,20221012163244,'-35 C',4);

SELECT*FROM Sensor JOIN MEDIDA ON fksensor = idSensor ORDER BY LOCALIZAÇÃO ASC;










 



